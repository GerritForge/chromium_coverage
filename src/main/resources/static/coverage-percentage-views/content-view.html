<script>
  const _coveragePercentageContentObject = {
    properties: {
      changeNum: String,
      patchRange: Object,
      path: String,
      provider: Function,
      percentageText: String,
      type: String,
    },

    observers: [
      '_computePercentage(changeNum, patchRange, path, provider)',
    ],

    async _computePercentage(changeNum, patchRange, path, provider) {
      this.percentageText = '-';
      if (!changeNum || !patchRange || !path || !provider) {
        return;
      }

      const p = await provider(changeNum, path, patchRange.patchNum);
      if (p && p[this.type]) {
        this.percentageText = p[this.type] + '%';
      }
    },
  }
</script>

<dom-module id="absolute-content-view">
  <template>
    <style>
      :host {
        display: none;
        min-width: 3.5em;
        text-align: center;
      }
    </style>
    [[percentageText]]
  </template>

  <script>
    (function() {
    'use strict';

      const properties = Object.assign(
          {}, _coveragePercentageContentObject.properties);
      properties.type = { type: String, value: 'absolute', readOnly: true };
      Polymer({
        is: 'absolute-content-view',

        properties: properties,

        observers: _coveragePercentageContentObject.observers,

        _computePercentage: _coveragePercentageContentObject._computePercentage,
      });
    })();
  </script>
</dom-module>

<dom-module id="incremental-content-view">
  <template>
    <style>
      :host {
        display: none;
        min-width: 3.5em;
        text-align: center;
      }
    </style>
    [[percentageText]]
  </template>

  <script>
    (function() {
    'use strict';

      const properties = Object.assign(
          {}, _coveragePercentageContentObject.properties);
      properties.type = { type: String, value: 'incremental', readOnly: true };
      Polymer({
        is: 'incremental-content-view',

        properties: properties,

        observers: _coveragePercentageContentObject.observers,

        _computePercentage: _coveragePercentageContentObject._computePercentage,
      });
    })();
  </script>
</dom-module>
