<script>
  'use strict'
  function _coveragePercentageContentObject(is, type) {
    return {
      is: is,

      properties: {
        changeNum: String,
        patchRange: Object,
        path: String,
        provider: Function,
        percentageText: String,
      },

      observers: [
        '_computePercentage(changeNum, patchRange, path, provider)'
      ],

      async _computePercentage(changeNum, patchRange, path, provider) {
        this.percentageText = '-';
        if (!changeNum || !patchRange || !path || !provider) {
          return;
        }

        const p = await provider(changeNum, path, patchRange.patchNum);
        if (p && p[type]) {
          this.percentageText = p[type] + '%';
        }
      }
    };
  }
</script>

<dom-module id="absolute-content-view">
  <template>
    <style>
      :host {
        display: none;
        min-width: 3.5em;
        text-align: center;
      }
    </style>
    [[percentageText]]
  </template>

  <script>
    'use strict';
    (function() {
      Polymer(_coveragePercentageContentObject('absolute-content-view',
                                               'absolute'));
    })();
  </script>
</dom-module>

<dom-module id="incremental-content-view">
  <template>
    <style>
      :host {
        display: none;
        min-width: 3.5em;
        text-align: center;
      }
    </style>
    [[percentageText]]
  </template>

  <script>
    'use strict';
    (function() {
      Polymer(_coveragePercentageContentObject('incremental-content-view',
                                               'incremental'));
    })();
  </script>
</dom-module>
